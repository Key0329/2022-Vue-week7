import{_ as E,f as b,m as T,r as _,o as d,c as r,e,F as v,h as g,i as V,t as i,b as n,w as x,d as y,g as C,v as U,q as u,s as w}from"./index-b5affa4f.js";import{c as k,s as D}from"./cartStore-ab720c41.js";const{VITE_PATH:S,VITE_URL:A}={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"key0329",VITE_TEXT:"這是產品的環境",BASE_URL:"/2022-Vue-week7/",MODE:"production",DEV:!1,PROD:!0},q={data(){return{form:{user:{name:"",email:"",tel:"",address:""},message:""}}},computed:{...b(k,["cart"]),...b(D,["loadingItem"])},methods:{isPhone(s){return/^(09)[0-9]{8}$/.test(s)?!0:"請填入 09 為開頭的十位數手機號碼"},...T(k,["deleteAllCart","deleteCartItem","getCartsData","updateCartItem"]),createOrder(){if(this.cart.carts.length===0){alert("購物車內無品項");return}const s=this.form;this.$http.post(`${A}/api/${S}/order`,{data:s}).then(t=>{alert(`${t.data.message}，訂單號碼為 ${t.data.orderId}`),this.getCartsData()}).catch(t=>{alert(t.response.data.message)}),this.$refs.form.resetForm(),this.form.message=""}},mounted(){this.getCartsData();const s=this.$loading.show();setTimeout(()=>{s.hide()},1e3)}},N={class:"container"},P={class:"mt-4"},B={key:0},L=e("h5",null,"購物車內尚無商品",-1),O=[L],R={key:1},F={class:"text-end"},M={class:"table align-middle"},H=e("thead",null,[e("tr",null,[e("th"),e("th",null,"品名"),e("th",{style:{width:"150px"}},"數量/單位"),e("th",null,"單價")])],-1),j=["disabled","onClick"],z={key:0,class:"fas fa-spinner fa-pulse"},X={class:"input-group input-group-sm"},G=["disabled","onUpdate:modelValue","onChange"],J=["value"],K={class:"text-end"},Q=e("small",{class:"text-success"},"折扣價：",-1),W=e("td",{colspan:"3",class:"text-end"},"總計",-1),Y={class:"text-end"},Z=e("td",{colspan:"3",class:"text-end text-success"},"折扣價",-1),$={class:"text-end text-success"},ee={class:"my-5 row justify-content-center text-start"},se={class:"mb-3"},te=e("label",{for:"email",class:"form-label"},"Email",-1),le={class:"mb-3"},oe=e("label",{for:"name",class:"form-label"},"收件人姓名",-1),ae={class:"mb-3"},ne=e("label",{for:"tel",class:"form-label"},"收件人電話",-1),de={class:"mb-3"},re=e("label",{for:"address",class:"form-label"},"收件人地址",-1),ie={class:"mb-3"},me=e("label",{for:"message",class:"form-label"},"留言",-1),ce={class:"text-end"},ue=["disabled"];function _e(s,t,fe,he,a,f){var h,p;const m=_("v-field"),c=_("error-message"),I=_("v-form");return d(),r("div",N,[e("div",P,[(p=(h=s.cart)==null?void 0:h.carts)!=null&&p.length?(d(),r("div",R,[e("div",F,[e("button",{class:"btn btn-outline-danger",type:"button",onClick:t[0]||(t[0]=(...l)=>s.deleteAllCart&&s.deleteAllCart(...l))}," 清空購物車 ")]),e("table",M,[H,e("tbody",null,[s.cart.carts?(d(!0),r(v,{key:0},g(s.cart.carts,l=>(d(),r("tr",{key:l.id},[e("td",null,[e("button",{type:"button",class:"btn btn-outline-danger btn-sm",disabled:l.id===s.loadingItem,onClick:o=>s.deleteCartItem(l)},[l.id===s.loadingItem?(d(),r("i",z)):V("",!0),y(" x ")],8,j)]),e("td",null,i(l.product.title)+" ",1),e("td",null,[e("div",X,[C(e("select",{name:"",id:"",class:"form-control",disabled:l.id===s.loadingItem,"onUpdate:modelValue":o=>l.qty=o,onChange:o=>s.updateCartItem(l)},[(d(),r(v,null,g(20,o=>e("option",{value:o,key:o},i(o),9,J)),64))],40,G),[[U,l.qty]])])]),e("td",K,[Q,y(" "+i(l.final_total),1)])]))),128)):V("",!0)]),e("tfoot",null,[e("tr",null,[W,e("td",Y,i(s.cart.total),1)]),e("tr",null,[Z,e("td",$,i(s.cart.final_total),1)])])])])):(d(),r("div",B,O))]),e("div",ee,[n(I,{ref:"form",class:"col-md-6",onSubmit:f.createOrder},{default:x(({errors:l})=>[e("div",se,[te,n(m,{id:"email",name:"email",type:"email",class:u(["form-control",{"is-invalid":l.email}]),placeholder:"請輸入 Email",modelValue:a.form.user.email,"onUpdate:modelValue":t[1]||(t[1]=o=>a.form.user.email=o),rules:"email|required"},null,8,["modelValue","class"]),n(c,{name:"email",class:"invalid-feedback"})]),e("div",le,[oe,n(m,{id:"name",label:"姓名",name:"username",type:"text",class:u(["form-control",{"is-invalid":l.username}]),placeholder:"請輸入姓名",modelValue:a.form.user.name,"onUpdate:modelValue":t[2]||(t[2]=o=>a.form.user.name=o),rules:"required"},null,8,["modelValue","class"]),n(c,{name:"username",class:"invalid-feedback"})]),e("div",ae,[ne,n(m,{id:"tel",name:"tel",label:"電話",type:"tel",class:u(["form-control",{"is-invalid":l.tel}]),placeholder:"請輸入電話",modelValue:a.form.user.tel,"onUpdate:modelValue":t[3]||(t[3]=o=>a.form.user.tel=o),rules:f.isPhone},null,8,["modelValue","class","rules"]),n(c,{name:"tel",class:"invalid-feedback"})]),e("div",de,[re,n(m,{id:"address",name:"address",label:"地址",type:"text",class:u(["form-control",{"is-invalid":l.address}]),placeholder:"請輸入地址",modelValue:a.form.user.address,"onUpdate:modelValue":t[4]||(t[4]=o=>a.form.user.address=o),rules:"required"},null,8,["modelValue","class"]),n(c,{name:"address",class:"invalid-feedback"})]),e("div",ie,[me,C(e("textarea",{id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":t[5]||(t[5]=o=>a.form.message=o)},null,512),[[w,a.form.message]])]),e("div",ce,[e("button",{type:"submit",class:"btn btn-danger",disabled:a.form.user.address===""||a.form.user.email===""||a.form.user.name===""||a.form.user.tel===""}," 送出訂單 ",8,ue)])]),_:1},8,["onSubmit"])])])}const ve=E(q,[["render",_e]]);export{ve as default};
